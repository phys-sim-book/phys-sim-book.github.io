<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MUDA_APP: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MUDA_APP
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Main Page </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md0">Introduction</a><ul><li class="level2"><a href="#autotoc_md1">What is muda?</a></li>
<li class="level2"><a href="#autotoc_md2">Why muda?</a></li>
<li class="level2"><a href="#autotoc_md3">A substitution of thrust?</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md4">Overview</a><ul><li class="level2"><a href="#autotoc_md5">Launch</a></li>
<li class="level2"><a href="#autotoc_md6">Logger</a></li>
<li class="level2"><a href="#autotoc_md7">Buffer</a></li>
<li class="level2"><a href="#autotoc_md8">Viewer In Kernel</a></li>
<li class="level2"><a href="#autotoc_md9">Event And Stream</a></li>
<li class="level2"><a href="#autotoc_md10">Asynchronous Operation</a></li>
<li class="level2"><a href="#autotoc_md11">[Extension] Linear System Support</a></li>
<li class="level2"><a href="#autotoc_md12">[Extension] Field Layout</a></li>
<li class="level2"><a href="#autotoc_md13">Compute Graph</a></li>
<li class="level2"><a href="#autotoc_md14">Dynamic Parallelism</a></li>
<li class="level2"><a href="#autotoc_md15">MUDA vs. CUDA</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md16">Build</a><ul><li class="level2"><a href="#autotoc_md17">Xmake</a></li>
<li class="level2"><a href="#autotoc_md18">Cmake</a></li>
<li class="level2"><a href="#autotoc_md19">Copy Headers</a></li>
<li class="level2"><a href="#autotoc_md20">Macro</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md21">Tutorial</a></li>
<li class="level1"><a href="#autotoc_md22">Examples</a></li>
<li class="level1"><a href="#autotoc_md23">Contributing</a></li>
<li class="level1"><a href="#autotoc_md24">Related Work</a></li>
</ul>
</div>
<div class="textblock"><p>MUDA is <b>Î¼-CUDA</b>, yet another painless CUDA programming <b>paradigm</b>.</p>
<blockquote class="doxtable">
<p>&zwj;COVER THE LAST MILE OF CUDA </p>
</blockquote>
<h1><a class="anchor" id="autotoc_md0"></a>
Introduction</h1>
<h2><a class="anchor" id="autotoc_md1"></a>
What is muda?</h2>
<ul>
<li>Header-only library right out of the box</li>
<li>Depends only on CUDA and standard libraries</li>
<li>Improve readability, maintainability, security, and debugging efficiency of CUDA code.</li>
<li>Reduce the difficulty of building CUDA Graphs and increase automation.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2"></a>
Why muda?</h2>
<p>Think that you wanna try a new idea or implement a demo with CUDA. If the demo works well, you want to embed it into your project quickly. But you find that using CUDA directly will be a catastrophic disaster.</p>
<p>Coding with C-API CUDA, you will be buried in irrelevant details, and the information density of the code is very low, which means that you need to write a lot of redundant code to achieve a simple function. Less is more, right?</p>
<p>Debugging the GPU code is a nightmare. How much time do you spend on those weird Error Codes from CUDA, and finally find it's an illegal memory access?</p>
<p><img src="img/question_head_gakuzen_boy.png" alt="" style="zoom: 20%;" class="inline"/></p>
<p>Using a GPU Debugger when something goes wrong may be an approach. But the best way is to prevent bugs from happening, right? Most of the time, automatic range checking is all we want. It's a pretty fantasy that someone tells you, "Hey Bro, at `Block 103, Thread 45`, in kernel named `set_up_array`, the buffer named `array` goes out of range because your index is `100` while the array size is `96`." After that, it exits the kernel and stops the program for you to prevent later chained dummy bugs from producing confusing debug information.</p>
<p>It is muda!</p>
<p>If you access memory resource using a MUDA <b>Viewer</b>. Dear muda will tell you all about that.</p>
<p>MUDA also provides an elegant way to create and update <a href="https://developer.nvidia.com/blog/cuda-graphs/">CUDA Graph</a>, called MUDA <code>ComputeGraph</code>.</p>
<ul>
<li>Users almost take only a bit of effort to switch from the Stream-Base Launch Mode to Graph Launch Mode.</li>
<li>Updating the node parameters and shared resources in CUDA Graphs becomes intuitive, safe, and efficient.</li>
</ul>
<p>Simple to extend.</p>
<ul>
<li>User can obey the primary interface of muda to define their own object to reuse the MUDA facility</li>
<li>Almost all "Resource View Type" can be used directly in the MUDA <code>ComputeGraph</code>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md3"></a>
A substitution of thrust?</h2>
<p><b>Nop!</b> MUDA is a supplement of thrust!</p>
<blockquote class="doxtable">
<p>&zwj;<a href="https://docs.nvidia.com/cuda/thrust/index.html">Thrust</a> is a C++ template library for CUDA based on the Standard Template Library (STL). Thrust allows you to implement high-performance parallel applications with minimal programming effort through a high-level interface that is fully interoperable with CUDA C. </p>
</blockquote>
<p>Using iterators to prevent range error is a high-level approach. However, we still need to access the memory manually in our own kernel, no matter whether using raw cuda kernel launch <code>&lt;&lt;&lt;&gt;&gt;&gt;</code> or using thrust agent kernel (most of the time, using a <code>thrust::counting_iterator</code> in a <code>thrust::for_each</code> algorithm).</p>
<p>So, I think MUDA is a mid-level approach. We have the same purpose but different levels and aim at different problems. Feel comfortable to use them together!</p>
<p>Here is an example for using Thrust and MUDA together.</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span>muda;</div>
<div class="line"><span class="keyword">using namespace </span>thrust;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">constexpr</span> <span class="keyword">auto</span> N = 10;</div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_device_vector.html">DeviceVector&lt;float&gt;</a> x(N); <span class="comment">// DeviceVector is derived from thrust::device_vector  </span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_kernel_label.html">KernelLabel</a> lebal{<span class="stringliteral">&quot;setup_concise&quot;</span>}; <span class="comment">// give a kernel label for better debug info</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// equivalent to parallel for </span></div>
<div class="line">for_each(thrust::cuda::par_nosync, <span class="comment">// no sync after execution</span></div>
<div class="line">         make_counting_iterator(0), make_counting_iterator(N), <span class="comment">// make a sequence from 0 -&gt; N</span></div>
<div class="line">         [x = x.viewer().name(<span class="stringliteral">&quot;x&quot;</span>)] __device__(<span class="keywordtype">int</span> i) <span class="keyword">mutable</span></div>
<div class="line">         {</div>
<div class="line">             x(i) = i; <span class="comment">// safe access through muda viewer</span></div>
<div class="line">         });</div>
<div class="ttc" id="aclassmuda_1_1_device_vector_html"><div class="ttname"><a href="classmuda_1_1_device_vector.html">muda::DeviceVector</a></div><div class="ttdef"><b>Definition</b> vector.h:23</div></div>
<div class="ttc" id="aclassmuda_1_1_kernel_label_html"><div class="ttname"><a href="classmuda_1_1_kernel_label.html">muda::KernelLabel</a></div><div class="ttdef"><b>Definition</b> kernel_label.h:7</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md4"></a>
Overview</h1>
<p>This is a quick overview of some muda APIs.</p>
<p>You can check it to find out something useful for you. A comprehensive description of MUDA is placed at Tutorial.</p>
<h2><a class="anchor" id="autotoc_md5"></a>
Launch</h2>
<p>Simple, self-explanatory, intellisense-friendly Launcher.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;muda/muda.h&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span>muda;</div>
<div class="line">__global__ <span class="keywordtype">void</span> raw_kernel()</div>
<div class="line">{</div>
<div class="line">    printf(<span class="stringliteral">&quot;hello muda!\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// just launch</span></div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_launch.html">Launch</a>(1, 1)</div>
<div class="line">        .apply(</div>
<div class="line">        [] __device__() </div>
<div class="line">        {</div>
<div class="line">            print(<span class="stringliteral">&quot;hello muda!\n&quot;</span>); </div>
<div class="line">        }).wait();</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> N = 8;</div>
<div class="line">    <span class="comment">// dynamic grid</span></div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_parallel_for.html">ParallelFor</a>(256 <span class="comment">/*block size*/</span>)</div>
<div class="line">        .apply(N,</div>
<div class="line">        [] __device__(<span class="keywordtype">int</span> i) </div>
<div class="line">        {</div>
<div class="line">            print(<span class="stringliteral">&quot;hello muda %d!\n&quot;</span>, i); </div>
<div class="line">        }).wait();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// grid stride loop</span></div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_parallel_for.html">ParallelFor</a>(8  <span class="comment">/*grid size*/</span>, </div>
<div class="line">                32 <span class="comment">/*block size*/</span>)</div>
<div class="line">        .apply(N,</div>
<div class="line">        [] __device__(<span class="keywordtype">int</span> i) </div>
<div class="line">        {</div>
<div class="line">            print(<span class="stringliteral">&quot;hello muda %d!\n&quot;</span>, i); </div>
<div class="line">        }).wait();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// automatic block size choosing</span></div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_parallel_for.html">ParallelFor</a>().apply(N,</div>
<div class="line">        [] __device__(<span class="keywordtype">int</span> i) </div>
<div class="line">        {</div>
<div class="line">            print(<span class="stringliteral">&quot;hello muda %d!\n&quot;</span>, i); </div>
<div class="line">        }).wait();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// intellisense-friendly wrapper </span></div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_kernel.html">Kernel</a>{32<span class="comment">/*grid size*/</span>, 64<span class="comment">/*block size*/</span>,0<span class="comment">/*shared memory*/</span>, stream, other_kernel}(...)</div>
<div class="line">}</div>
<div class="ttc" id="aclassmuda_1_1_kernel_html"><div class="ttname"><a href="classmuda_1_1_kernel.html">muda::Kernel</a></div><div class="ttdef"><b>Definition</b> kernel.h:11</div></div>
<div class="ttc" id="aclassmuda_1_1_launch_html"><div class="ttname"><a href="classmuda_1_1_launch.html">muda::Launch</a></div><div class="ttdoc">A wrapper of raw cuda kernel launch in muda style, removing the &lt;&lt;&lt;&gt;&gt;&gt; usage, for better intellisense...</div><div class="ttdef"><b>Definition</b> launch.h:86</div></div>
<div class="ttc" id="aclassmuda_1_1_parallel_for_html"><div class="ttname"><a href="classmuda_1_1_parallel_for.html">muda::ParallelFor</a></div><div class="ttdoc">a frequently used parallel for loop, DynamicBlockDim and GridStrideLoop strategy are provided,...</div><div class="ttdef"><b>Definition</b> parallel_for.h:116</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md6"></a>
Logger</h2>
<p>A <code>std::cout</code> like output stream with overload formatting.</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classmuda_1_1_logger.html">Logger</a> logger;</div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_launch.html">Launch</a>(2, 2)</div>
<div class="line">    .apply(</div>
<div class="line">        [logger = logger.viewer()] __device__() <span class="keyword">mutable</span></div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// type override</span></div>
<div class="line">            logger &lt;&lt; <span class="stringliteral">&quot;int2: &quot;</span> &lt;&lt; make_int2(1, 2) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">            logger &lt;&lt; <span class="stringliteral">&quot;float3: &quot;</span> &lt;&lt; make_float3(1.0f, 2.0f, 3.0f) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        })</div>
<div class="line">    .wait();</div>
<div class="line"><span class="comment">// download the result to any ostream you like. </span></div>
<div class="line">logger.retrieve(std::cout);</div>
<div class="ttc" id="aclassmuda_1_1_logger_html"><div class="ttname"><a href="classmuda_1_1_logger.html">muda::Logger</a></div><div class="ttdef"><b>Definition</b> logger.h:36</div></div>
</div><!-- fragment --><p>You can define a global<code>__device__ LoggerViewer cout</code> and call the overloaded constructor <code>Logger(LoggerViewer* global_viewer)</code> to use it without any capturing, which is useful when you need to use logger in some function but don't want to put the <code>LoggerViewer</code> in the function parameter.</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>foo</div>
<div class="line">{</div>
<div class="line">__device__ <a class="code hl_class" href="classmuda_1_1_logger_viewer.html">LoggerViewer</a> cout;</div>
<div class="line">__device__ <span class="keywordtype">void</span> say_hello() { cout &lt;&lt; <span class="stringliteral">&quot;hello global logger!\n&quot;</span>; }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// setup global logger</span></div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_logger_viewer.html">LoggerViewer</a>* viewer_ptr = <span class="keyword">nullptr</span>;</div>
<div class="line">    checkCudaErrors(cudaGetSymbolAddress((<span class="keywordtype">void</span>**)&amp;viewer_ptr, foo::cout));</div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_logger.html">Logger</a> logger(viewer_ptr);</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_launch.html">Launch</a>().apply([]__device__() <span class="keyword">mutable</span></div>
<div class="line">        {</div>
<div class="line">            foo::say_hello();</div>
<div class="line">        })</div>
<div class="line">    .wait();</div>
<div class="line">    </div>
<div class="line">    logger.retrieve(std::cout);</div>
<div class="line">}</div>
<div class="ttc" id="aclassmuda_1_1_logger_viewer_html"><div class="ttname"><a href="classmuda_1_1_logger_viewer.html">muda::LoggerViewer</a></div><div class="ttdef"><b>Definition</b> logger_viewer.h:47</div></div>
</div><!-- fragment --><p>Further, you can use <code>muda::Debug::set_sync_callback()</code> to retrieve the output once <code>wait()</code> is called, as:</p>
<div class="fragment"><div class="line">__device__ <a class="code hl_class" href="classmuda_1_1_logger_viewer.html">LoggerViewer</a> cout;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// setup global logger</span></div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_logger_viewer.html">LoggerViewer</a>* viewer_ptr = <span class="keyword">nullptr</span>;</div>
<div class="line">    checkCudaErrors(cudaGetSymbolAddress((<span class="keywordtype">void</span>**)&amp;viewer_ptr, foo::cout));</div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_logger.html">Logger</a> logger(viewer_ptr);</div>
<div class="line">    </div>
<div class="line">    muda::Debug::set_sync_callback([&amp;] { logger.retrieve(std::cout); });</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_launch.html">Launch</a>().apply([]__device__() <span class="keyword">mutable</span></div>
<div class="line">        {</div>
<div class="line">            cout &lt;&lt; <span class="stringliteral">&quot;hello\n&quot;</span>;</div>
<div class="line">        })</div>
<div class="line">    .wait();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// no need to retrieve manully</span></div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md7"></a>
Buffer</h2>
<p>A lightweight <code>std::vector</code>-like cuda device memory container.</p>
<p>In addition, 2D/3D aligned buffers are also provided.</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classmuda_1_1_device_buffer.html">DeviceBuffer&lt;int&gt;</a> buffer;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// copy from std::vector</span></div>
<div class="line">std::vector&lt;int&gt; host(8);</div>
<div class="line">buffer.copy_from(host);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// copy to raw memory</span></div>
<div class="line"><span class="keywordtype">int</span> host_array[8];</div>
<div class="line">buffer.copy_to(host_array);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// use BufferView to copy sub-buffer</span></div>
<div class="line">buffer.view(0,4).copy_from(host.data());</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_device_buffer.html">DeviceBuffer&lt;int&gt;</a> dst_buffer{4};</div>
<div class="line"><span class="comment">// use BufferView to copy sub-buffer</span></div>
<div class="line">buffer.view(0,4).copy_to(dst_buffer.view());</div>
<div class="line"> </div>
<div class="line"><span class="comment">// safe and easy resize</span></div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_device_buffer2_d.html">DeviceBuffer2D&lt;int&gt;</a> buffer2d;</div>
<div class="line">buffer2d.resize(<a class="code hl_class" href="classmuda_1_1_extent2_d.html">Extent2D</a>{5, 5}, 1);</div>
<div class="line">buffer2d.resize(<a class="code hl_class" href="classmuda_1_1_extent2_d.html">Extent2D</a>{7, 2}, 2);</div>
<div class="line">buffer2d.resize(<a class="code hl_class" href="classmuda_1_1_extent2_d.html">Extent2D</a>{2, 7}, 3);</div>
<div class="line">buffer2d.resize(<a class="code hl_class" href="classmuda_1_1_extent2_d.html">Extent2D</a>{9, 9}, 4);</div>
<div class="line"><span class="comment">// subview </span></div>
<div class="line">buffer2d.view(<a class="code hl_class" href="classmuda_1_1_offset2_d.html">Offset2D</a>{1,1}, <a class="code hl_class" href="classmuda_1_1_extent2_d.html">Extent2D</a>{3,3});</div>
<div class="line">buffer2d.copy_to(host);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_device_buffer3_d.html">DeviceBuffer3D&lt;int&gt;</a> buffer3d;</div>
<div class="line">buffer3d.resize(<a class="code hl_class" href="classmuda_1_1_extent3_d.html">Extent3D</a>{3, 4, 5}, 1);</div>
<div class="line">buffer3d.copy_to(host);</div>
<div class="ttc" id="aclassmuda_1_1_device_buffer2_d_html"><div class="ttname"><a href="classmuda_1_1_device_buffer2_d.html">muda::DeviceBuffer2D</a></div><div class="ttdef"><b>Definition</b> device_buffer_2d.h:13</div></div>
<div class="ttc" id="aclassmuda_1_1_device_buffer3_d_html"><div class="ttname"><a href="classmuda_1_1_device_buffer3_d.html">muda::DeviceBuffer3D</a></div><div class="ttdef"><b>Definition</b> device_buffer_3d.h:23</div></div>
<div class="ttc" id="aclassmuda_1_1_device_buffer_html"><div class="ttname"><a href="classmuda_1_1_device_buffer.html">muda::DeviceBuffer</a></div><div class="ttdoc">A std::vector like wrapper of cuda device memory, allows user to:</div><div class="ttdef"><b>Definition</b> device_buffer.h:46</div></div>
<div class="ttc" id="aclassmuda_1_1_extent2_d_html"><div class="ttname"><a href="classmuda_1_1_extent2_d.html">muda::Extent2D</a></div><div class="ttdef"><b>Definition</b> extent.h:10</div></div>
<div class="ttc" id="aclassmuda_1_1_extent3_d_html"><div class="ttname"><a href="classmuda_1_1_extent3_d.html">muda::Extent3D</a></div><div class="ttdef"><b>Definition</b> extent.h:40</div></div>
<div class="ttc" id="aclassmuda_1_1_offset2_d_html"><div class="ttname"><a href="classmuda_1_1_offset2_d.html">muda::Offset2D</a></div><div class="ttdef"><b>Definition</b> extent.h:72</div></div>
</div><!-- fragment --><p>The old data will be safely kept if you resize a 2D or 3D buffer. If you don't want to keep the old data, use <code>.clear()</code> before your <code>.resize()</code>. The result of the above chain of 2D buffer resizing is shown below.</p>
<p><img src="img/buffer2d_resize.svg" alt="buffer2d_resize" style="pointer-events: none; zoom: 80%;" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md8"></a>
Viewer In Kernel</h2>
<p>MUDA <b>Viewers</b> provide safe inner-kernel memory access, which checks all input to ensure access does not go out of range and does not dereference a null pointer. If something goes wrong, they report the debug information as much as possible and trap the kernel to prevent further errors. Don't forget to fill the <code>kernel_name()</code> and <code>name()</code> out.</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classmuda_1_1_device_var.html">DeviceVar&lt;int&gt;</a> single;</div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_device_buffer.html">DeviceBuffer&lt;int&gt;</a> array;</div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_device_buffer2_d.html">DeviceBuffer2D&lt;int&gt;</a> array2d;</div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_device_buffer3_d.html">DeviceBuffer3D&lt;int&gt;</a> array3d;</div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_logger.html">Logger</a> logger;</div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_launch.html">Launch</a>()</div>
<div class="line">    .kernel_name(__FUNCTION__)</div>
<div class="line">    .apply(</div>
<div class="line">    [</div>
<div class="line">        single  = single.viewer().name(<span class="stringliteral">&quot;single&quot;</span>), <span class="comment">// give a name for more readable debug info</span></div>
<div class="line">        array   = buffer.viewer().name(<span class="stringliteral">&quot;array&quot;</span>),</div>
<div class="line">        array2d = buffer_2d.viewer().name(<span class="stringliteral">&quot;array2d&quot;</span>),</div>
<div class="line">        array3d = buffer_3d.viewer().name(<span class="stringliteral">&quot;array3d&quot;</span>),</div>
<div class="line">        logger  = logger.viewer(),</div>
<div class="line">        ...</div>
<div class="line">    ] __device__ () <span class="keyword">mutable</span></div>
<div class="line">    {</div>
<div class="line">        single = 1;</div>
<div class="line">        array(i) = 1;</div>
<div class="line">        array2d(offset_in_height, offset_in_width) = 1;</div>
<div class="line">        array3d(offset_in_depth, offset_in_height, offset_in_width) = 1;</div>
<div class="line">        logger &lt;&lt; 1;</div>
<div class="line">    });</div>
<div class="ttc" id="aclassmuda_1_1_device_var_html"><div class="ttname"><a href="classmuda_1_1_device_var.html">muda::DeviceVar</a></div><div class="ttdef"><b>Definition</b> device_var.h:11</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md9"></a>
Event And Stream</h2>
<p>If you don't want to launch something on the default stream, use <code>Stream</code> to create async streams. And you can use <code>Event</code> to synchronize between streams.</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classmuda_1_1_stream.html">Stream</a>         s1, s2;</div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_event.html">Event</a>          set_value_done;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_device_var.html">DeviceVar&lt;int&gt;</a> v = 1;</div>
<div class="line">on(s1)</div>
<div class="line">    .next&lt;<a class="code hl_class" href="classmuda_1_1_launch.html">Launch</a>&gt;(1, 1)</div>
<div class="line">    .apply(</div>
<div class="line">        [v = v.viewer()] __device__() mutable</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordtype">int</span> next = 2;</div>
<div class="line">            v = next;</div>
<div class="line">        })</div>
<div class="line">    .record(set_value_done)</div>
<div class="line">    .apply(</div>
<div class="line">        [] __device__()</div>
<div class="line">        {</div>
<div class="line">            some_work();</div>
<div class="line">        });</div>
<div class="line"> </div>
<div class="line">on(s2)</div>
<div class="line">    .when(set_value_done)</div>
<div class="line">    .next&lt;<a class="code hl_class" href="classmuda_1_1_launch.html">Launch</a>&gt;(1, 1)</div>
<div class="line">    .apply([v = v.viewer()] __device__()</div>
<div class="line">           { <span class="keywordtype">int</span> res = v; });</div>
<div class="ttc" id="aclassmuda_1_1_event_html"><div class="ttname"><a href="classmuda_1_1_event.html">muda::Event</a></div><div class="ttdoc">RAII wrapper for cudaEvent.</div><div class="ttdef"><b>Definition</b> event.h:15</div></div>
<div class="ttc" id="aclassmuda_1_1_stream_html"><div class="ttname"><a href="classmuda_1_1_stream.html">muda::Stream</a></div><div class="ttdoc">RAII wrapper for cudaStream.</div><div class="ttdef"><b>Definition</b> stream.h:18</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md10"></a>
Asynchronous Operation</h2>
<p>MUDA <b>Launchers</b>' functions are Asynchronous, meaning we need to call <code>.wait()</code> to synchronize it on the host, unlike some APIs such as <code>BufferView::copy_fom</code>. NOTE: Operations of a <b>Launcher</b> will be asynchronous as possible, so you should synchronize the stream by yourself, while other APIs will synchronize themselves.</p>
<div class="fragment"><div class="line"><span class="comment">// kernel launch</span></div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_kernel.html">Kernel</a>{..., f}(...);</div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_launch.html">Launch</a>(stream).apply(...).wait();</div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_parallel_for.html">ParallelFor</a>(stream).apply(N, ...).wait();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// graph launch</span></div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_graph_launch.html">GraphLaunch</a>().launch(graph).wait();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Memory</span></div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_memory.html">Memory</a>(stream).copy(...).wait();</div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_memory.html">Memory</a>(stream).set(...).wait();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Buffer: for BufferView/Buffer2DView/Buffer3DView</span></div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_buffer_launch.html">BufferLaunch</a>(stream).copy(<a class="code hl_class" href="classmuda_1_1_buffer_view.html">BufferView</a>, ...).wait();</div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_buffer_launch.html">BufferLaunch</a>(stream).fill(<a class="code hl_class" href="classmuda_1_1_buffer_view.html">BufferView</a>,...).wait();</div>
<div class="ttc" id="aclassmuda_1_1_buffer_launch_html"><div class="ttname"><a href="classmuda_1_1_buffer_launch.html">muda::BufferLaunch</a></div><div class="ttdef"><b>Definition</b> buffer_launch.h:37</div></div>
<div class="ttc" id="aclassmuda_1_1_buffer_view_html"><div class="ttname"><a href="classmuda_1_1_buffer_view.html">muda::BufferView</a></div><div class="ttdef"><b>Definition</b> buffer_view.h:162</div></div>
<div class="ttc" id="aclassmuda_1_1_graph_launch_html"><div class="ttname"><a href="classmuda_1_1_graph_launch.html">muda::GraphLaunch</a></div><div class="ttdef"><b>Definition</b> graph_launch.h:8</div></div>
<div class="ttc" id="aclassmuda_1_1_memory_html"><div class="ttname"><a href="classmuda_1_1_memory.html">muda::Memory</a></div><div class="ttdef"><b>Definition</b> memory.h:8</div></div>
</div><!-- fragment --><p>Feel free to ignore <code>Memory</code> <code>BufferLaunch</code> <b>Launcher</b> when building your fast demo. Directly use the convenient synchronous APIs of <code>DeviceBuffer/BufferView</code> until you find it's the performance hotpot that will save you a lot of time.</p>
<p>It's a good practice to keep <b>Launchers</b> asynchronous while keeping other APIs synchronous, which obeys the 80/20 rule.</p>
<h2><a class="anchor" id="autotoc_md11"></a>
[Extension] Linear System Support</h2>
<p>[We are still working on this part]</p>
<p><b>MUDA</b> supports basic linear system operations. e.g.:</p>
<ol type="1">
<li>Sparse Matrix Format Conversion</li>
<li>Sparse Matrix Assembly</li>
<li>Linear System Solving</li>
</ol>
<p><img src="./img/linear_system.drawio.svg" alt="" style="pointer-events: none; zoom:50%;" class="inline"/></p>
<p>The only thing you need to do is to declare a <code><a class="el" href="classmuda_1_1_linear_system_context.html">muda::LinearSystemContext</a></code>.</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classmuda_1_1_linear_system_context.html">LinearSystemContext</a> ctx;</div>
<div class="line"><span class="comment">// non-unique triplets of (row_index, col_index, block3x3)</span></div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_device_triplet_matrix.html">DeviceTripletMatrix&lt;float, 3&gt;</a> A_triplet;</div>
<div class="line"><span class="comment">// setup the triplet matrix dimension</span></div>
<div class="line">A_triplet.reshape(block_rows,block_cols);</div>
<div class="line"><span class="comment">// resize the triplets, we should know the total count of the triplets.</span></div>
<div class="line">A_triplet.resize_triplets(hessian_count); </div>
<div class="line"> </div>
<div class="line"><span class="comment">// unique triplets of (row_index, col_index, block3x3) faster SPMV than TripletMatrix</span></div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_device_b_c_o_o_matrix.html">DeviceBCOOMatrix&lt;float,3&gt;</a> A_bcoo; </div>
<div class="line"> </div>
<div class="line"><span class="comment">// block compressed sparse row format, faster SPMV than BCOOMatrix</span></div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_device_b_s_r_matrix.html">DeviceBSRMatrix&lt;float,3&gt;</a> A_bsr; </div>
<div class="line"> </div>
<div class="line"><span class="comment">// compressed sparse row format, slower SPMV than BSRMatrix</span></div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_device_c_s_r_matrix.html">DeviceCSRMatrix&lt;float,3&gt;</a> A_csr</div>
<div class="line"> </div>
<div class="line"><span class="comment">// trivial dense matrix </span></div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_device_dense_matrix.html">DeviceDenseMatrix&lt;float&gt;</a> A_dense; </div>
<div class="line"> </div>
<div class="line"><span class="comment">// convert:</span></div>
<div class="line">ctx.convert(A_triplet, A_bcoo);</div>
<div class="line">ctx.convert(A_bcoo, A_bsr);</div>
<div class="line">ctx.convert(A_bsr, A_dense);</div>
<div class="line">ctx.convert(A_bsr, A_csr);</div>
<div class="line">ctx.convert(A_bcoo, A_dense);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// so for the Sparse Vector ...</span></div>
<div class="ttc" id="aclassmuda_1_1_device_b_c_o_o_matrix_html"><div class="ttname"><a href="classmuda_1_1_device_b_c_o_o_matrix.html">muda::DeviceBCOOMatrix</a></div><div class="ttdef"><b>Definition</b> device_bcoo_matrix.h:18</div></div>
<div class="ttc" id="aclassmuda_1_1_device_b_s_r_matrix_html"><div class="ttname"><a href="classmuda_1_1_device_b_s_r_matrix.html">muda::DeviceBSRMatrix</a></div><div class="ttdef"><b>Definition</b> device_bsr_matrix.h:16</div></div>
<div class="ttc" id="aclassmuda_1_1_device_c_s_r_matrix_html"><div class="ttname"><a href="classmuda_1_1_device_c_s_r_matrix.html">muda::DeviceCSRMatrix</a></div><div class="ttdef"><b>Definition</b> device_csr_matrix.h:16</div></div>
<div class="ttc" id="aclassmuda_1_1_device_dense_matrix_html"><div class="ttname"><a href="classmuda_1_1_device_dense_matrix.html">muda::DeviceDenseMatrix</a></div><div class="ttdef"><b>Definition</b> device_dense_matrix.h:16</div></div>
<div class="ttc" id="aclassmuda_1_1_device_triplet_matrix_html"><div class="ttname"><a href="classmuda_1_1_device_triplet_matrix.html">muda::DeviceTripletMatrix</a></div><div class="ttdef"><b>Definition</b> device_triplet_matrix.h:14</div></div>
<div class="ttc" id="aclassmuda_1_1_linear_system_context_html"><div class="ttname"><a href="classmuda_1_1_linear_system_context.html">muda::LinearSystemContext</a></div><div class="ttdef"><b>Definition</b> linear_system_context.h:28</div></div>
</div><!-- fragment --><p>We only allow users to assemble a Sparse Matrix from Triplet Matrix. And allow users to read from BCOOMatrix.</p>
<p>To assemble a Triplet Matrix, user need to use the <code>viewer</code> of a Triplet Matrix.</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classmuda_1_1_device_triplet_matrix.html">DeviceTripletMatrix&lt;float, 3&gt;</a> A_triplet;</div>
<div class="line">A_triplet.resize(block_rows,block_cols,hessian_count);</div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_device_dense_vector.html">DeviceDenseVector&lt;float&gt;</a> x, b;</div>
<div class="line">x.resize(block_rows * 3);</div>
<div class="line">b.resize(block_rows * 3)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="classmuda_1_1_parallel_for.html">ParallelFor</a>(256<span class="comment">/*block size*/</span>)</div>
<div class="line">    .apply(hessian_count,</div>
<div class="line">    [</div>
<div class="line">        H = A_triplet.viewer().name(<span class="stringliteral">&quot;Hessian&quot;</span>),</div>
<div class="line">        g = x.viewer().name(<span class="stringliteral">&quot;gradient&quot;</span>)</div>
<div class="line">        <span class="comment">// some infos to build up hessian and gradient</span></div>
<div class="line">    ] __device__(<span class="keywordtype">int</span> i) </div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">int</span> row, col;</div>
<div class="line">        Eigen::Matrix3f hessian; <span class="comment">// fill the local hessian, using your infos</span></div>
<div class="line">        Eigen::Vector3f gradient;</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// write the (row, col, hessian) to the i-th triplet</span></div>
<div class="line">        H(i).write(row,col, hessin);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">// atomic add the gradient vector</span></div>
<div class="line">        g.segment&lt;3&gt;(row * 3).atomic_add(gradient);</div>
<div class="line">    }).wait();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// convert to bcoo for better performance on SPMV.</span></div>
<div class="line">ctx.convert(A_triplet, A_bcoo);</div>
<div class="line">ctx.convert(A_bcoo, A_bsr);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// maybe in some iterative solver:</span></div>
<div class="line">ctx.spmv(A_bsr.cview(), x.cview(), b.view());</div>
<div class="ttc" id="aclassmuda_1_1_device_dense_vector_html"><div class="ttname"><a href="classmuda_1_1_device_dense_vector.html">muda::DeviceDenseVector</a></div><div class="ttdef"><b>Definition</b> device_dense_vector.h:16</div></div>
</div><!-- fragment --><p>[TODO:] Later, we may involve <a href="https://en.wikipedia.org/wiki/Expression_templates">Expression Template</a> to strengthen the linear algebra calculation and use lazy evaluation to arrange as many element-wise/scattering operations as possible in a single kernel.</p>
<h2><a class="anchor" id="autotoc_md12"></a>
[Extension] Field Layout</h2>
<p>MUDA now supports the <code>SoA/AoS/AoSoA</code> layouts. Users can switch between them seamlessly(with different builder parameters). The copy operation in all directions and layouts is well-supported.</p>
<p>Most of the time, <code>AoSoA</code> is the best layout for Vector and Matrix, with better <a href="https://nichijou.co/cuda5-coalesce/">memory coalescing</a> and more compact memory storage. With the help of <code>Eigen::Map&lt;&gt;</code>, the read/write of a Vector/Matrix is as trivial as accessing a struct-version Vector/Matrix.</p>
<p>Here is a simple example of <code><a class="el" href="classmuda_1_1_field.html">muda::Field</a></code>.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;muda/ext/field.h&gt;</span> <span class="comment">// all you need for muda::Field</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> field_example(FieldEntryLayout layout)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">using namespace </span>muda;</div>
<div class="line">    <span class="keyword">using namespace </span>Eigen;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_field.html">Field</a> field;</div>
<div class="line">    <span class="comment">// create a subfield called &quot;particle&quot;</span></div>
<div class="line">    <span class="comment">// any entry in this field has the same size</span></div>
<div class="line">    <span class="keyword">auto</span>&amp; particle = field[<span class="stringliteral">&quot;particle&quot;</span>];</div>
<div class="line">    <span class="keywordtype">float</span> dt       = 0.01f;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// build the field:</span></div>
<div class="line">    <span class="comment">// auto builder = particle.AoSoA(); // compile time layout</span></div>
<div class="line">    <span class="keyword">auto</span> builder = particle.builder(FieldEntryLayout::AoSoA);  <span class="comment">// runtime layout</span></div>
<div class="line">    <span class="keyword">auto</span>&amp; m      = builder.entry(<span class="stringliteral">&quot;mass&quot;</span>).scalar&lt;<span class="keywordtype">float</span>&gt;();</div>
<div class="line">    <span class="keyword">auto</span>&amp; pos    = builder.entry(<span class="stringliteral">&quot;position&quot;</span>).vector3&lt;<span class="keywordtype">float</span>&gt;();</div>
<div class="line">    <span class="keyword">auto</span>&amp; pos_old = builder.entry(<span class="stringliteral">&quot;position_old&quot;</span>).vector3&lt;<span class="keywordtype">float</span>&gt;();</div>
<div class="line">    <span class="keyword">auto</span>&amp; vel     = builder.entry(<span class="stringliteral">&quot;velocity&quot;</span>).vector3&lt;<span class="keywordtype">float</span>&gt;();</div>
<div class="line">    <span class="keyword">auto</span>&amp; force   = builder.entry(<span class="stringliteral">&quot;force&quot;</span>).vector3&lt;<span class="keywordtype">float</span>&gt;();</div>
<div class="line">    <span class="comment">// matrix is also supported, but in this example we don&#39;t use it</span></div>
<div class="line">    <span class="keyword">auto</span>&amp; I = builder.entry(<span class="stringliteral">&quot;inertia&quot;</span>).matrix3x3&lt;<span class="keywordtype">float</span>&gt;();</div>
<div class="line">    builder.build();  <span class="comment">// finish building the field</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// set size of the particle attributes</span></div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> N = 10;</div>
<div class="line">    particle.resize(N);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_logger.html">Logger</a> logger;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_parallel_for.html">ParallelFor</a>(256)</div>
<div class="line">        .kernel_name(<span class="stringliteral">&quot;setup_vars&quot;</span>)</div>
<div class="line">        .apply(N,</div>
<div class="line">               [logger = logger.viewer(),</div>
<div class="line">                m      = m.viewer(),</div>
<div class="line">                pos    = pos.viewer(),</div>
<div class="line">                vel    = vel.viewer(),</div>
<div class="line">                f      = force.viewer()] __device__ (<span class="keywordtype">int</span> i) <span class="keyword">mutable</span></div>
<div class="line">               {</div>
<div class="line">                   m(i)   = 1.0f;</div>
<div class="line">                   <span class="comment">// a row of particles with position=(i,1,0)</span></div>
<div class="line">                   pos(i) = Vector3f::UnitY() + Vector3f::UnitX() * i;</div>
<div class="line">                   vel(i) = Vector3f::Zero();</div>
<div class="line">                   f(i)   = Vector3f{0.0f, -9.8f, 0.0f};</div>
<div class="line"> </div>
<div class="line">                   logger &lt;&lt; <span class="stringliteral">&quot;--------------------------------\n&quot;</span></div>
<div class="line">                          &lt;&lt; <span class="stringliteral">&quot;i=&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                          &lt;&lt; <span class="stringliteral">&quot;m=&quot;</span> &lt;&lt; m(i) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                          &lt;&lt; <span class="stringliteral">&quot;pos=&quot;</span> &lt;&lt; pos(i) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                          &lt;&lt; <span class="stringliteral">&quot;vel=&quot;</span> &lt;&lt; vel(i) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                          &lt;&lt; <span class="stringliteral">&quot;f=&quot;</span> &lt;&lt; f(i) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">               })</div>
<div class="line">        .wait();</div>
<div class="line"> </div>
<div class="line">    logger.retrieve();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_parallel_for.html">ParallelFor</a>(256)</div>
<div class="line">        .kernel_name(<span class="stringliteral">&quot;integration&quot;</span>)</div>
<div class="line">        .apply(N,</div>
<div class="line">               [logger = logger.viewer(),</div>
<div class="line">                m      = m.cviewer(),</div>
<div class="line">                pos    = pos.viewer(),</div>
<div class="line">                vel    = vel.viewer(),</div>
<div class="line">                f      = force.cviewer(),</div>
<div class="line">                dt] __device__ (<span class="keywordtype">int</span> i) <span class="keyword">mutable</span></div>
<div class="line">               {</div>
<div class="line">                   <span class="keyword">auto</span>     x = pos(i);</div>
<div class="line">                   <span class="keyword">auto</span>     v = vel(i);</div>
<div class="line">                   Vector3f a = f(i) / m(i);</div>
<div class="line"> </div>
<div class="line">                   v = v + a * dt;</div>
<div class="line">                   x = x + v * dt;</div>
<div class="line"> </div>
<div class="line">                   logger &lt;&lt; <span class="stringliteral">&quot;--------------------------------\n&quot;</span></div>
<div class="line">                          &lt;&lt; <span class="stringliteral">&quot;i=&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                          &lt;&lt; <span class="stringliteral">&quot;m=&quot;</span> &lt;&lt; m(i) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                          &lt;&lt; <span class="stringliteral">&quot;pos=&quot;</span> &lt;&lt; pos(i) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                          &lt;&lt; <span class="stringliteral">&quot;vel=&quot;</span> &lt;&lt; vel(i) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">                          &lt;&lt; <span class="stringliteral">&quot;f=&quot;</span> &lt;&lt; f(i) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">               })</div>
<div class="line">        .wait();</div>
<div class="line"> </div>
<div class="line">    logger.retrieve();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// copy between entry and host</span></div>
<div class="line">    std::vector&lt;Vector3f&gt; positions;</div>
<div class="line">    pos.copy_to(positions);</div>
<div class="line">    pos.copy_from(positions);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// copy between entries</span></div>
<div class="line">    pos_old.copy_from(pos);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// copy between buffer and entry</span></div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_device_buffer.html">DeviceBuffer&lt;Vector3f&gt;</a> pos_buf;</div>
<div class="line">    pos.copy_to(pos_buf);</div>
<div class="line">    pos.copy_from(pos_buf);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// using cub to do reduction on any format</span></div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_device_var.html">DeviceVar&lt;float&gt;</a> total_mass;</div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_device_reduce.html">DeviceReduce</a>().Sum(m.view(), total_mass.view(), m.count());</div>
<div class="line">}</div>
<div class="ttc" id="aclassmuda_1_1_device_reduce_html"><div class="ttname"><a href="classmuda_1_1_device_reduce.html">muda::DeviceReduce</a></div><div class="ttdef"><b>Definition</b> device_reduce.h:12</div></div>
<div class="ttc" id="aclassmuda_1_1_field_html"><div class="ttname"><a href="classmuda_1_1_field.html">muda::Field</a></div><div class="ttdef"><b>Definition</b> field.h:17</div></div>
</div><!-- fragment --><p>Additionally, resizing a subfield will resize all the entries, and the resizing is safe; all entries will be copied to a new buffer if the new size exceeds the capacity.</p>
<div class="fragment"><div class="line"><span class="comment">// safe resize, all entries will be copied to the new buffer.</span></div>
<div class="line">particle.resize(N * 2);</div>
</div><!-- fragment --><p>It'd be useful if the topology will change in your simulation. For example, the fracture simulation always changes its tetrahedron mesh, and all attributes of particles, edges, triangles, and tetrahedra will change correspondently. It will be terrible if you resize all the attributes yourself.</p>
<p>Note that every <code>FieldEntry</code> has a <code>View</code> called <code>FieldEntryView</code>. A <code>FieldEntryView</code> can be regarded as a <code>ComputeGraphVar</code>(see below), which means <code>FieldEntry</code> can also be used in <code>ComputeGraph</code>.</p>
<h2><a class="anchor" id="autotoc_md13"></a>
Compute Graph</h2>
<p>Define <code>MUDA_WITH_COMPUTE_GRAPH</code> to turn on <code>Compute Graph</code> support.</p>
<p><b>MUDA</b> can generate <code>cudaGraph</code> nodes and dependencies from your <code>eval()</code> call. And the <code>cudaGraphExec</code> will be automatically updated (minimally) if you update a <code><a class="el" href="classmuda_1_1_compute_graph_var.html">muda::ComputeGraphVar</a></code>. More details in <a href="https://zhuanlan.zhihu.com/p/658080362">zhihu_ZH</a>.</p>
<p>Define a muda compute graph:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> compute_graph_simple()</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_compute_graph_var_manager.html">ComputeGraphVarManager</a> manager;</div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_compute_graph.html">ComputeGraph</a> graph{manager};</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 1) define GraphVars</span></div>
<div class="line">    <span class="keyword">auto</span>&amp; N   = manager.create_var&lt;<span class="keywordtype">size_t</span>&gt;(<span class="stringliteral">&quot;N&quot;</span>);</div>
<div class="line">    <span class="comment">// BufferView represents a fixed range of memory</span></div>
<div class="line">    <span class="comment">// dynamic memory allocation is not allowed in GraphVars</span></div>
<div class="line">    <span class="keyword">auto</span>&amp; x_0 = manager.create_var&lt;<a class="code hl_class" href="classmuda_1_1_buffer_view.html">BufferView&lt;Vector3&gt;</a>&gt;(<span class="stringliteral">&quot;x_0&quot;</span>);</div>
<div class="line">    <span class="keyword">auto</span>&amp; x   = manager.create_var&lt;<a class="code hl_class" href="classmuda_1_1_buffer_view.html">BufferView&lt;Vector3&gt;</a>&gt;(<span class="stringliteral">&quot;x&quot;</span>);</div>
<div class="line">    <span class="keyword">auto</span>&amp; y   = manager.create_var&lt;<a class="code hl_class" href="classmuda_1_1_buffer_view.html">BufferView&lt;Vector3&gt;</a>&gt;(<span class="stringliteral">&quot;y&quot;</span>);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// 2) create GraphNode</span></div>
<div class="line">    graph.create_node(<span class="stringliteral">&quot;cal_x_0&quot;</span>) &lt;&lt; [&amp;]</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// initialize values</span></div>
<div class="line">        <a class="code hl_class" href="classmuda_1_1_parallel_for.html">ParallelFor</a>(256).apply(N.eval(),</div>
<div class="line">                               [x_0 = x_0.eval().viewer()] __device__(<span class="keywordtype">int</span> i) <span class="keyword">mutable</span></div>
<div class="line">                               { x_0(i) = Vector3::Ones(); });</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    graph.create_node(<span class="stringliteral">&quot;copy_to_x&quot;</span>) <span class="comment">// copy</span></div>
<div class="line">        &lt;&lt; [&amp;] { <a class="code hl_class" href="classmuda_1_1_buffer_launch.html">BufferLaunch</a>().copy(x.eval(), x_0.ceval()); };</div>
<div class="line"> </div>
<div class="line">    graph.create_node(<span class="stringliteral">&quot;copy_to_y&quot;</span>) <span class="comment">// copy</span></div>
<div class="line">        &lt;&lt; [&amp;] { <a class="code hl_class" href="classmuda_1_1_buffer_launch.html">BufferLaunch</a>().copy(y.eval(), x_0.ceval()); };</div>
<div class="line"> </div>
<div class="line">    graph.create_node(<span class="stringliteral">&quot;print_x_y&quot;</span>) &lt;&lt; [&amp;]</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// print</span></div>
<div class="line">        <a class="code hl_class" href="classmuda_1_1_parallel_for.html">ParallelFor</a>(256).apply(N.eval(),</div>
<div class="line">                               [x = x.ceval().cviewer(),</div>
<div class="line">                                y = y.ceval().cviewer(),</div>
<div class="line">                                N = N.eval()] __device__(<span class="keywordtype">int</span> i) <span class="keyword">mutable</span></div>
<div class="line">                               {</div>
<div class="line">                                   <span class="keywordflow">if</span>(N &lt;= 10)</div>
<div class="line">                                       print(<span class="stringliteral">&quot;[%d] x = (%f,%f,%f) y = (%f,%f,%f) \n&quot;</span>,</div>
<div class="line">                                             i,</div>
<div class="line">                                             x(i).x(),</div>
<div class="line">                                             x(i).y(),</div>
<div class="line">                                             x(i).z(),</div>
<div class="line">                                             y(i).x(),</div>
<div class="line">                                             y(i).y(),</div>
<div class="line">                                             y(i).z());</div>
<div class="line">                               });</div>
<div class="line">    };</div>
<div class="line">    <span class="comment">// 3) visualize it using graphviz (for debug)</span></div>
<div class="line">    graph.graphviz(std::cout);</div>
<div class="line">}</div>
<div class="ttc" id="aclassmuda_1_1_compute_graph_html"><div class="ttname"><a href="classmuda_1_1_compute_graph.html">muda::ComputeGraph</a></div><div class="ttdef"><b>Definition</b> compute_graph.h:38</div></div>
<div class="ttc" id="aclassmuda_1_1_compute_graph_var_manager_html"><div class="ttname"><a href="classmuda_1_1_compute_graph_var_manager.html">muda::ComputeGraphVarManager</a></div><div class="ttdef"><b>Definition</b> compute_graph_var_manager.h:15</div></div>
</div><!-- fragment --><p><img src="./img/compute_graph.svg" alt="graphviz" style="pointer-events: none;" class="inline"/></p>
<p>Launch a muda compute graph:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> compute_graph_simple()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// resources</span></div>
<div class="line">    <span class="keyword">auto</span> N_value    = 4;</div>
<div class="line">    <span class="keyword">auto</span> x_0_buffer = <a class="code hl_class" href="classmuda_1_1_device_vector.html">DeviceVector&lt;Vector3&gt;</a>(N_value);</div>
<div class="line">    <span class="keyword">auto</span> x_buffer   = <a class="code hl_class" href="classmuda_1_1_device_vector.html">DeviceVector&lt;Vector3&gt;</a>(N_value);</div>
<div class="line">    <span class="keyword">auto</span> y_buffer   = <a class="code hl_class" href="classmuda_1_1_device_vector.html">DeviceVector&lt;Vector3&gt;</a>(N_value);</div>
<div class="line"> </div>
<div class="line">    N.update(N_value);</div>
<div class="line">    x_0.update(x_0_buffer);</div>
<div class="line">    x.update(x_buffer);</div>
<div class="line">    y.update(y_buffer);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// create stream</span></div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_stream.html">Stream</a> stream;</div>
<div class="line">    <span class="comment">// sync graph on stream</span></div>
<div class="line">    graph.launch(stream);</div>
<div class="line">    <span class="comment">// launch all nodes on a single stream (fallback to origin cuda kernel launch)</span></div>
<div class="line">    graph.launch(<span class="keyword">true</span>, stream);</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md14"></a>
Dynamic Parallelism</h2>
<p>MUDA support dynamic parallelism based on MUDA ComputeGraph.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> dynamic_parallelism_graph()</div>
<div class="line">{</div>
<div class="line">    std::vector&lt;int&gt; host(16);</div>
<div class="line">    std::iota(host.begin(), host.end(), 0);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_compute_graph_var_manager.html">ComputeGraphVarManager</a> manager;</div>
<div class="line">    <span class="comment">// create graph</span></div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_compute_graph.html">ComputeGraph</a>      graph{manager, <span class="stringliteral">&quot;graph&quot;</span>, ComputeGraphFlag::DeviceLaunch};</div>
<div class="line">    <span class="comment">// create resource</span></div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_device_buffer.html">DeviceBuffer&lt;int&gt;</a> src = host;</div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_device_buffer.html">DeviceBuffer&lt;int&gt;</a> dst(host.size());</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// create graph var</span></div>
<div class="line">    <span class="keyword">auto</span>&amp; src_var = manager.create_var(<span class="stringliteral">&quot;src&quot;</span>, src.view());</div>
<div class="line">    <span class="keyword">auto</span>&amp; dst_var = manager.create_var(<span class="stringliteral">&quot;dst&quot;</span>, dst.view());</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// create graph node</span></div>
<div class="line">    graph.$node(<span class="stringliteral">&quot;copy&quot;</span>)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_class" href="classmuda_1_1_buffer_launch.html">BufferLaunch</a>().copy(dst_var, src_var);</div>
<div class="line">    };</div>
<div class="line">    <span class="comment">// build graph</span></div>
<div class="line">    graph.build();</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// create a scheduler graph</span></div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_compute_graph.html">ComputeGraph</a> launch_graph{manager, <span class="stringliteral">&quot;launch_graph&quot;</span>, ComputeGraphFlag::DeviceLaunch};</div>
<div class="line">    <span class="keyword">auto</span>&amp; graph_var = manager.create_var(<span class="stringliteral">&quot;graph&quot;</span>, graph.viewer());</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// create a node to launch our graph</span></div>
<div class="line">    launch_graph.$node(<span class="stringliteral">&quot;launch&quot;</span>)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_class" href="classmuda_1_1_launch.html">Launch</a>().apply(</div>
<div class="line">            [graph = graph_var.ceval()] $()</div>
<div class="line">            {</div>
<div class="line">                graph.tail_launch();</div>
<div class="line">            });</div>
<div class="line">    };</div>
<div class="line">    <span class="comment">// graphviz all graph we created</span></div>
<div class="line">    manager.graphviz(std::cout);</div>
<div class="line">    <span class="comment">// launch and wait</span></div>
<div class="line">    launch_graph.launch().wait();</div>
<div class="line">}</div>
</div><!-- fragment --><p><img src="./img/dynamic_parallelism.svg" alt="image-20231119161837442" style="pointer-events: none;" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md15"></a>
MUDA vs. CUDA</h2>
<div class="fragment"><div class="line"><span class="comment">/* </span></div>
<div class="line"><span class="comment">* muda style</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"><span class="keywordtype">void</span> muda()</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_device_buffer.html">DeviceBuffer&lt;int&gt;</a>  dv(64);</div>
<div class="line">    dv.fill(1);</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_class" href="classmuda_1_1_parallel_for.html">ParallelFor</a>(256) <span class="comment">// parallel-semantic</span></div>
<div class="line">        .kernel_name(<span class="stringliteral">&quot;my_kernel&quot;</span>) <span class="comment">// or just .kernel_name(__FUNCTION__)</span></div>
<div class="line">        .apply(64, <span class="comment">// automatically cover the range</span></div>
<div class="line">               [</div>
<div class="line">                   <span class="comment">// mapping from the DeviceBuffer to a proper viewer</span></div>
<div class="line">                   <span class="comment">// which can be trivially copy through device and host</span></div>
<div class="line">                   dv = dv.viewer().name(<span class="stringliteral">&quot;dv&quot;</span>)</div>
<div class="line">               ] </div>
<div class="line">               __device__(<span class="keywordtype">int</span> i) <span class="keyword">mutable</span></div>
<div class="line">               { </div>
<div class="line">                   dv(i) *= 2; <span class="comment">// safe, the viewer check the boundary automatically</span></div>
<div class="line">               })</div>
<div class="line">        .wait();<span class="comment">// happy waiting, muda remember the stream.</span></div>
<div class="line">        <span class="comment">//.apply(...) //if you want to go forward with the same config, just call .apply() again.</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">/* </span></div>
<div class="line"><span class="comment">* cuda style</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// manually create kernel</span></div>
<div class="line">__global__ <span class="keywordtype">void</span> times2(<span class="keywordtype">int</span>* i, <span class="keywordtype">int</span> N) <span class="comment">// modifying parameters is horrible</span></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">auto</span> tid = threadIdx.x;</div>
<div class="line">    <span class="keywordflow">if</span>(tid &lt; N) <span class="comment">// check corner case manaully</span></div>
<div class="line">    {</div>
<div class="line">        i[tid] *= 2;<span class="comment">// unsafe: no boundary check at all</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> cuda()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// to be brief, we just use thrust to allocate memory</span></div>
<div class="line">    thrust::device_vector&lt;int&gt; dv(64, 1);</div>
<div class="line">    <span class="comment">// cast to raw pointer</span></div>
<div class="line">    <span class="keyword">auto</span> dvptr = thrust::raw_pointer_cast(dv.data());</div>
<div class="line">    <span class="comment">// create stream and check error</span></div>
<div class="line">    cudaStream_t s;</div>
<div class="line">    checkCudaErrors(cudaStreamCreate(&amp;s));</div>
<div class="line">    <span class="comment">// call the kernel (which always ruins the Intellisense, if you use VS.)</span></div>
<div class="line">    times2&lt;&lt;&lt;1, 64, 0, s&gt;&gt;&gt;(dvptr, dv.size());</div>
<div class="line">    <span class="comment">// boring waiting and error checking</span></div>
<div class="line">    checkCudaErrors(cudaStreamSynchronize(s));</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md16"></a>
Build</h1>
<h2><a class="anchor" id="autotoc_md17"></a>
Xmake</h2>
<p>Run example:</p>
<div class="fragment"><div class="line">$ xmake f --example=true</div>
<div class="line">$ xmake </div>
<div class="line">$ xmake run muda_example hello_muda</div>
</div><!-- fragment --><p> To show all examples:</p>
<div class="fragment"><div class="line">$ xmake run muda_example -l</div>
</div><!-- fragment --><p> Play all examples:</p>
<div class="fragment"><div class="line">$ xmake run muda_example</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md18"></a>
Cmake</h2>
<div class="fragment"><div class="line">$ mkdir CMakeBuild</div>
<div class="line">$ cd CMakeBuild</div>
<div class="line">$ cmake -S ..</div>
<div class="line">$ cmake --build .</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md19"></a>
Copy Headers</h2>
<p>Because <b>muda</b> is header-only, copy the <code>src/muda/</code> folder to your project, set the include directory, and everything is done.</p>
<h2><a class="anchor" id="autotoc_md20"></a>
Macro</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Macro   </th><th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Details    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>MUDA_CHECK_ON</code>   </td><td class="markdownTableBodyNone"><code>1</code>(default) or <code>0</code>   </td><td class="markdownTableBodyNone"><code>MUDA_CHECK_ON=1</code> for turn on all muda runtime check(for safety)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>MUDA_WITH_COMPUTE_GRAPH</code>   </td><td class="markdownTableBodyNone"><code>1</code>or<code>0</code>(default)   </td><td class="markdownTableBodyNone"><code>MUDA_WITH_COMPUTE_GRAPH=1</code> for turn on muda compute graph feature   </td></tr>
</table>
<p>If you manually copy the header files, don't forget to define the macros yourself. If you use cmake or xmake, just set the project dependency to muda.</p>
<h1><a class="anchor" id="autotoc_md21"></a>
Tutorial</h1>
<p>[TODO]</p>
<h1><a class="anchor" id="autotoc_md22"></a>
Examples</h1>
<p>All examples in <code>muda/example</code> are self-explanatory, enjoy it.</p>
<p><img src="./img/example-img.png" alt="image-20231102030703199" style="zoom:67%;" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md23"></a>
Contributing</h1>
<p>Contributions are welcome. We are looking for or are working on:</p>
<ol type="1">
<li><b>muda</b> development</li>
<li>fancy simulation demos using <b>muda</b></li>
<li>better documentation of <b>muda</b></li>
</ol>
<h1><a class="anchor" id="autotoc_md24"></a>
Related Work</h1>
<ul>
<li><p class="startli">Topological braiding simulation using <b>muda</b> (old version)</p>
<div class="fragment"><div class="line">@article{article,</div>
<div class="line">author = {Lu, Xinyu and Bo, Pengbo and Wang, Linqin},</div>
<div class="line">year = {2023},</div>
<div class="line">month = {07},</div>
<div class="line">pages = {},</div>
<div class="line">title = {Real-Time 3D Topological Braiding Simulation with Penetration-Free Guarantee},</div>
<div class="line">volume = {164},</div>
<div class="line">journal = {Computer-Aided Design},</div>
<div class="line">doi = {10.1016/j.cad.2023.103594}</div>
<div class="line">}</div>
</div><!-- fragment --><p class="startli"><img src="./img/braiding.png" alt="braiding" style="zoom:67%;" class="inline"/> </p>
</li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
